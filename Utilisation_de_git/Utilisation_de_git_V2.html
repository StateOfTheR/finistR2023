<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>FinistR : Utilisation de git</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Utilisation_de_git_V2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Utilisation_de_git_V2_files/libs/quarto-html/quarto.js"></script>
<script src="Utilisation_de_git_V2_files/libs/quarto-html/popper.min.js"></script>
<script src="Utilisation_de_git_V2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Utilisation_de_git_V2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Utilisation_de_git_V2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Utilisation_de_git_V2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Utilisation_de_git_V2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Utilisation_de_git_V2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Utilisation_de_git_V2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#chronologie-des-commandes" id="toc-chronologie-des-commandes" class="nav-link" data-scroll-target="#chronologie-des-commandes">Chronologie des commandes</a></li>
  <li><a href="#commandes-utilisées" id="toc-commandes-utilisées" class="nav-link" data-scroll-target="#commandes-utilisées">Commandes utilisées</a></li>
  <li><a href="#perspectives" id="toc-perspectives" class="nav-link" data-scroll-target="#perspectives">Perspectives</a></li>
  <li><a href="#liens-utiles" id="toc-liens-utiles" class="nav-link" data-scroll-target="#liens-utiles">Liens utiles</a></li>
  <li><a href="#remerciements" id="toc-remerciements" class="nav-link" data-scroll-target="#remerciements">Remerciements</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">FinistR : Utilisation de git</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">Invalid Date</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>L’objectif de cet atelier était de voir comment intéragir avec le dépôt github finistR2023 afin de pouvoir contribuer à la réalisation de la page web. Nous avons pour cela crée une branche dédiée à cet atelier sur laquelle nous avons interagi avec deux ordinateurs différents. Ce compte rendu consitste en la restitution chronologique des commandes exécutées par ces deux ordinateurs, et détaille les problèmes rencontrés en cours de route.</p>
</section>
<section id="chronologie-des-commandes" class="level1">
<h1>Chronologie des commandes</h1>
<p><strong>Ordinateur 1</strong></p>
<p>On commence par cloner le dépôt github StateOfTheR/finistR2023 :</p>
<p><code>git clone git@github.com:StateOfTheR/finistR2023.git</code></p>
<p>On crée une nouvelle branche pour cet atelier git :</p>
<p><code>git branch Utilisation_de_git</code></p>
<p>On se déplace sur cette branche :</p>
<p><code>git checkout Utilisation_de_git</code></p>
<p>On crée un fichier qmd dans un nouveau dossier dédié à cet atelier :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>mkdir Utilisation_de_git</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>cd Utilisation_de_git</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>nvim Utilisation_de_git.qmd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On commit les modification et on les push dans le dépôt.</p>
<pre><code>git add .
git commit -m "création d'une branche pour l'atelier sur git"
git push --set-upstream origin Utilisation_de_git </code></pre>
<p>La partie <code>--set-upstream origin Utilisation_de_git</code> de la troisième commande n’est utile que parce que la branche n’existe pas encore dans le dépôt. Les prochains push se feront simplement avec la commande <code>git push</code>.</p>
<p>A ce stade, le fichier Utilisation_de_git.qmd est comme suit :</p>
<p><img src="rmd_1.png" title="fichier Rmd" class="img-fluid"> <strong>————————————————————————————————————————————-</strong></p>
<p><strong>Ordinateur 2</strong></p>
<p>Avec le deuxième ordinateur, nous avons cloné le dépôt, nous nous sommes placés sur la branche crée précédemment, nous avons ajouté du texte au fichier qmd sans modifier le texte déjà présent, puis nous avons pushé ces modifications sur le dépôt. Le fichier Utilisation_de_git.qmd était comme suit au moment du push :</p>
<p><img src="rmd_2.png" class="img-fluid"> <strong>————————————————————————————————————————————-</strong></p>
<p><strong>Ordinateur 1</strong></p>
<p>En parallèle de cette opération, nous avons aussi fait un ajout de texte avec le premier ordinateur :</p>
<p><img src="rmd_3.png" class="img-fluid"></p>
<p>Après avoir commité cette ajout de texte, nous avons fait un git pull et nous avons eu un conflit auquel nous ne nous attendions pas étant donné la nature des différences entre le fichier sur le dépôt et le fichier en local. Le message d’erreur était le suivant :</p>
<p><mark style="background-color:yellow;">You have divergent branches and need to specify how to reconcile them. You can do so by running one of the following commands sometime before your next pull:</mark></p>
<ul>
<li><mark style="background-color:yellow;">git config pull.rebase false # merge (the default strategy)</mark></li>
<li><mark style="background-color:yellow;">git config pull.rebase true # rebase</mark></li>
<li><mark style="background-color:yellow;">git config pull.ff only # fast-forward only</mark></li>
</ul>
<p><mark style="background-color:yellow;">You can replace “git config” with “git config –global” to set a default preference for all repositories. You can also pass –rebase, –no-rebase, or –ff-only on the command line to override the configured default per invocation.</mark></p>
<p>Nous pensions pouvoir résoudre ce conflit en fast forward, nous avons donc configuré le pull de cette façon :</p>
<p><code>git config pull.ff only</code></p>
<p>Puis nous avons fait un git pull, mais cela n’a pas fonctionné.</p>
<p>Nous avons alors utilisé rebase :</p>
<p><code>git pull --rebase</code></p>
<p>Puis nous avons <strong>ouvert le fichier qmd pour gérer les conflits en supprimant les “=” et les “&gt;”</strong>, après quoi nous avons commité ces modifications. Nous avons alors essayé de faire un push et nous avons eu le message d’erreur suivant :</p>
<p><mark style="background-color:yellow;">fatal: You are not currently on a branch. To push the history leading to the current (detached HEAD) state now, use </mark></p>
<ul>
<li><mark style="background-color:yellow;">git push origin HEAD:&lt;name-of-the-remote-branch&gt; </mark></li>
</ul>
<p>Effectivement, la commande <code>git branch</code> nous donnait le résultat suivant :</p>
<p><mark style="background-color:yellow;">*(no branch, rebasing Utilisation_de_git)</mark><br> <mark style="background-color:yellow;">Utilisation_de_git</mark><br> <mark style="background-color:yellow;">main</mark></p>
<p>Nous avons résolu le problème avec</p>
<p><code>git rebase --continue</code></p>
<p>Et le push a ensuite bien fonctionné. <strong>————————————————————————————————————————————-</strong></p>
<p>A ce stade, nous nous sommes dits que nous avions mal géré le problème et que nous aurions dû utiliser la stratégie par défaut proposée dans le premier message d’erreur. Dans la suite, nous avons donc reconfiguré le pull (<code>git config pull.rebase false</code>) et nous avons recommencé ces ajouts de textes en parallèle avec les deux ordinateurs pour voir si c’était la bonne solution. Mais malgré cette reconfiguration du pull, git tentait toujours de le faire en fast forward. Cela venait de la commande <code>git config pull.ff only</code> exécutée précédemment et nous nous en sommes rendu compte en utilisant la commande <code>git config -l</code> qui permet de voir la configuration de certaines commandes git. Nous avons donc reconfiguré pull.ff :</p>
<p><code>git config pull.ff false</code></p>
<p>Et le merge des deux fichiers a bien fonctionné.</p>
<p>Au cours de ce travail, nous avons utilisé l’application gitk (installée avec <code>sudo apt install gitk</code>) qui permet de visualiser l’arbre des commits d’un répertoire git. Cette application s’utilise simplement en exécutant la commande <code>gitk</code> depuis le répertoire git désiré. Des options sont disponible pour customiser la vue et en particulier pour filtrer certaines branches de l’arbre (aller dans View &gt; New view). La figure ci-dessous représente l’arbre de notre branche à la fin des différents tests que l’on a effectués.</p>
<p><img src="arbre_git_1.png" class="img-fluid"></p>
<p>Par ailleurs, un point important à mentionner est le recours à la commande <code>history</code> de bash pour accéder à l’historique de ce dernier (aussi accessible dans le fichier ~/.bash_history (pour les linuxiens)). En effet, cela nous a permis de retracer ce qui s’était passé et de mieux comprendre certaines choses. Nous avons cependant regrété que les log des commandes git ne soient pas automatiquement sauvegardés. Cela nous aurait beaucoup aidé.</p>
</section>
<section id="commandes-utilisées" class="level1">
<h1>Commandes utilisées</h1>
<p><em>Commandes précédées de git</em></p>
<ul>
<li>clone</li>
<li>branch
<ul>
<li>branch -a</li>
<li>branch <em>new_branch_name</em></li>
</ul></li>
<li>checkout</li>
<li>status</li>
<li>add</li>
<li>commit -m</li>
<li>push</li>
<li>pull
<ul>
<li>pull</li>
<li>pull –rebase</li>
<li>pull –merge</li>
</ul></li>
<li>status</li>
<li>config
<ul>
<li>config -l</li>
</ul></li>
<li>rebase –continue</li>
<li>log
<ul>
<li>log</li>
<li>log –online</li>
</ul></li>
</ul>
</section>
<section id="perspectives" class="level1">
<h1>Perspectives</h1>
<p>Au cours de cet atelier, nous avons pu voir l’intérêt de git pour un projet collaboratif comme celui de la réalisation d’un site web. Néanmoins, n’étant pour la plupart d’entre nous que des utilisateurs novices de git dont l’utilisation se résume parfois à celle d’un simple drive, nous nous sommes demandés quels bénéfices nous pouvions en tirer pour une utilisation solitaire. En particulier pour en finir avec les répertoires remplis de fichiers comme analyse.ipynb, analyse_V2.ipynb, …, analyse_Vn.ipynb, dont l’un des intérêts est que cela permet de travailler simultanément sur plusieurs fichiers à la fois.</p>
<p>Une solution basée sur la création de différentes branches et des commandes <code>git stash</code> et <code>git pop</code>a émergé au moment de la restitution orale et sera testé dans un futur proche.</p>
</section>
<section id="liens-utiles" class="level1">
<h1>Liens utiles</h1>
<ul>
<li><a href="https://learngitbranching.js.org/">learngitbranching</a></li>
</ul>
</section>
<section id="remerciements" class="level1">
<h1>Remerciements</h1>
<p>Un grand merci à Marie-Pierre sans qui cet atelier aurait pû durer très longtemps !</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>